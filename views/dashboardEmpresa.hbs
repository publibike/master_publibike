<div id="contenidoPf">
  <div class="ui one column grid content user-data">
    <div class="column">
      {{!-- <div class="inside-column">
                <div class="ui three column grid" style="background:linear-gradient(90deg, rgba(6,224,201,1) 0%, rgba(4,124,148,1) 47%, rgba(4,135,116,1) 100%);;">
                    <div class="column">
                        <h4><small>Nombre</small>{{usuario.nombre}}</h4>
                    </div>
                    <div class="column">
                        <h4><small>Correo Electrónico</small>{{usuario.email}}</h4>
                    </div>
                    <div class="column">
                        <h4><small>Empresa</small>{{usuario.empresa.nombre}}</h4>
                    </div>
                </div>
            </div> --}}
    </div>
  </div>

  <div class="row">
    <div class="col-sm-6">
      <div class="card">
        <div
          class="card-header"
          style="background: #fff;border-color: #18e1cf;"
        >
          {{! <div class="col-md-10"> }}
          <i class="bookmark icon"></i>
          {{! <div class="header"> }}
          <font style="vertical-align: inherit;">
            <font style="vertical-align: inherit;color: #18e1cf;"><b>Plan
                gratuito</b></font>
          </font>
          {{!
                    </div> }}
          {{! </div> }}
          {{! <div class="col-md-2"> }}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <button class="ui teal submit button">Exportar PDF</button>
          {{! </div> }}

        </div>

        <div class="card-body" style="background: #f2f3f3;">
          <form
            class="ui form center"
            method="POST"
            action="/api/admin/filtrarRecorrido/{{this.id}}"
          >
            <center>
              <h2 class="ui dividing header">Filtrar Por rango de Fechas</h2>
            </center>
            <div class="fields">
              <div class="eight wide field">
                <label>Fecha Inicio</label>
                <input type="date" name="FechaInicio" required />
              </div>
              <div class="eight wide field">
                <label>Fecha Fin</label>
                <input type="date" name="FechaFin" required />
              </div>
            </div>
            <div class="field">
              <button
                type="submit"
                id="filtrar"
                class="ui fluid large teal submit button"
              >Filtar</button>
            </div>
          </form>
          <br />
          <div id="contentPdf">
            <div class="ui grid center">
              <div class="seven wide column">
                <div class="ui cards" style="width: 260px;">
                  <div class="card">

                    <div class="content">
                      <div class="header">
                        <font style="vertical-align: inherit;">
                          <font style="vertical-align: inherit;">Horas de
                            actividad física
                          </font>
                        </font>
                      </div>

                      <div
                        class="description"
                        id="description"
                        style="font-size:45px;background:#06e0c9;
                                            color:white;border-radius: 12px;"
                      >
                        <font style="vertical-align: inherit;">
                          <center>
                            <font style="vertical-align: inherit;">
                              {{empresa.tiempo}}
                            </font>
                          </center>
                        </font>
                      </div><br />
                      <div class="meta">
                        <font style="vertical-align: inherit;">
                          <font style="vertical-align: inherit;">Horas - Minutos
                            - Segundos
                          </font>
                        </font>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="seven wide column">
                <div class="ui cards" style="width: 350px;">
                  <div class="card">
                    <div class="content">
                      <div class="header">
                        <font style="vertical-align: inherit;">
                          <font style="vertical-align: inherit;">KMs recorridos</font>
                        </font>
                      </div>

                      <div class="description" style="font-size:45px">
                        <font style="vertical-align: inherit;">
                          <font style="vertical-align: inherit;">
                            {{!-- {{usuario.km_total}} --}}
                            {{empresa.km}}
                          </font>
                        </font>
                      </div>
                      <br />
                      <div class="meta">
                        <font style="vertical-align: inherit;">
                          <font style="vertical-align: inherit;">KMs
                          </font>
                        </font>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="ui one column centered grid">
            <div class="column">
              <div class="ui cards">
                <div class="card" style="width: 550px;">
                  <div class="content">
                    <div class="header">
                      <font style="vertical-align: inherit;">
                        <font style="vertical-align: inherit;">Viajes Realizados</font>
                      </font>
                    </div>

                    <div class="description" style="font-size:45px">
                      <canvas
                        id="line-chart1"
                        style="height: 300px;width: 450px;"
                      ></canvas>
                      <canvas id="line-chart3"></canvas>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="four column centered row">
              <div class="column">

              </div>
              <div class="column">

              </div>
            </div>
          </div>
          <div class="ui grid center">
            <div class="seven wide column">
              <div class="ui cards" style="width: 260px;">
                <div class="card">
                  <div class="content">
                    <div class="header">
                      <font style="vertical-align: inherit;">
                        <font style="vertical-align: inherit;">Calorías quemadas</font>
                      </font>
                    </div>

                    <div class="description" style="font-size:45px">
                      <font style="vertical-align: inherit;">
                        <font style="vertical-align: inherit;">
                          {{!-- {{usuario.cal_total}} --}}
                          {{empresa.cal}}
                        </font>
                      </font>
                    </div>
                    <br />
                    <div class="meta">
                      <font style="vertical-align: inherit;">
                        <font style="vertical-align: inherit;">Kcal</font>
                      </font>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="seven wide column">
              <div class="ui cards" style="width: 360px;">
                <div class="card">
                  <div class="content">
                    <div class="header">
                      <font style="vertical-align: inherit;">
                        <font style="vertical-align: inherit;">Habitos de
                          Movilidad
                        </font>
                      </font>
                    </div>

                    <div class="description" style="font-size:45px">
                      <canvas id="line-chart2"></canvas>

                    </div>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-6">
      <div class="card">
        <div
          class="card-header"
          style="background: #fff;border-color: #18e1cf;"
        >
          <i class="bookmark icon"></i>
          {{! <div class="header"> }}
          <font style="vertical-align: inherit;">
            <font style="vertical-align: inherit;color: #18e1cf;"><b>Plan
                premium</b></font>
          </font>
          {{!
                    </div> }}
        </div>
        <div
          class="card-body"
          style="background: linear-gradient(90deg, rgba(6,224,201,1) 0%, rgba(4,124,148,1) 47%, rgba(4,135,116,1) 100%);"
        >
          <form
            class="ui form center"
            method="POST"
            action="/api/admin/filtrarRecorrido/{{this.id}}"
          >
            <center>
              <h2 class="ui dividing header">Filtrar Por rango de Fechas</h2>
            </center>
            <div class="fields">
              <div class="eight wide field">
                <label>Fecha Inicio</label>
                <input type="date" name="FechaInicio" required />
              </div>
              <div class="eight wide field">
                <label>Fecha Fin</label>
                <input type="date" name="FechaFin" required />
              </div>
            </div>
            <div class="field">
              <button
                type="submit"
                class="ui fluid large teal submit button"
                style="background: #042640;"
              >Filtar</button>
            </div>
          </form>
          <br />
          <div class="fields">
            <div class="eight wide center">
              <div class="ui cards">
                <div class="card" style="width: 700px;height: 300px;">
                  <div class="content">
                    <div class="header">
                      <font style="vertical-align: inherit;">
                        <font style="vertical-align: inherit;">Co2 dejado de
                          emitir</font>
                      </font>
                    </div>

                    <div class="description" style="font-size:45px">
                      <canvas
                        id="line-chart"
                        style="width: 700px;height: 300px;"
                      ></canvas>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            {{! <div class="ui grid center"> }}
            {{! <div class="five wide column"> }}
            <br /><br />
            <div class="row">
              <div class="col-md-4">
                <div class="card mb-3" style="max-width: 540px;">
                  <label><center><b>SMARTPHONE CARGADOS&nbsp;&nbsp;&nbsp;</b></center></label>
                  <div class="row g-0">
                    <div class="col-md-4">
                      <img
                        src="/assets/img/celular.PNG"
                        class="img-fluid rounded-start"
                        alt="..."
                      />
                    </div>
                    <div class="col-md-8">
                      <div class="card-body">
                        <p class="card-title" style="font-size: 16px;">{{empresa.smartphones}}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="card mb-3" style="max-width: 540px;">
                  <label><center><b>PLANTULAS SEMBRADAS&nbsp;&nbsp;&nbsp;</b></center></label>
                  <div class="row g-0">
                    <div class="col-md-4">
                      <img
                        src="/assets/img/planta.PNG"
                        class="img-fluid rounded-start"
                        alt="..."
                      />
                    </div>
                    <div class="col-md-8">
                      <div class="card-body">
                        <p class="card-title" style="font-size: 16px;">{{empresa.numeroPlantulas}}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="card mb-3" style="max-width: 540px;">
                  <label><center><b>BOLSAS DE BASURA RECICLADAS</b></center></label>
                  <div class="row g-0">
                    <div class="col-md-4">
                      <img
                        src="/assets/img/basura.PNG"
                        class="img-fluid rounded-start"
                        alt="..."
                      />
                    </div>
                    <div class="col-md-8">
                      <div class="card-body">
                        <p class="card-title" style="font-size: 16px;">{{empresa.bolsasRecicladas}}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            {{! <div class="ui cards">
                                    <div class="card">

                                        <div class="content">
                                            <div class="header">
                                                <font style="vertical-align: inherit;">
                                                    <font style="vertical-align: inherit;">
                                                        <center>Smartphone cargados</center>
                                                    </font>
                                                </font>
                                            </div>

                                            <div class="description" style="font-size:45px">
                                                <font style="vertical-align: inherit;">
                                                    <font style="vertical-align: inherit;">
                                                        <center>14</center>
                                                    </font>
                                                </font>
                                            </div><br>
                                            <div class="meta">
                                                <font style="vertical-align: inherit;">
                                                    <font style="vertical-align: inherit;">
                                                        <center><i class="mobile alternate icon"></i></center>
                                                    </font>
                                                </font>
                                            </div>
                                        </div>
                                    </div>
                                </div> }}
            {{!
                            </div> }}
            {{! <div class="five wide column">
                                <div class="ui cards">
                                    <div class="card">
                                        <div class="content">
                                            <div class="header">
                                                <font style="vertical-align: inherit;">
                                                    <font style="vertical-align: inherit;">Plantulas sembradas</font>
                                                </font>
                                            </div>

                                            <div class="description" style="font-size:45px">
                                                <font style="vertical-align: inherit;">
                                                    <font style="vertical-align: inherit;">
                                                        120
                                                    </font>
                                                </font>
                                            </div>
                                            <br>
                                            <div class="meta">
                                                <font style="vertical-align: inherit;">
                                                    <font style="vertical-align: inherit;"><i class="leaf icon"></i>
                                                    </font>
                                                </font>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="five wide column">
                                <div class="ui cards">
                                    <div class="card">
                                        <div class="content">
                                            <div class="header" style="font-size: 16px;">
                                                <font style="vertical-align: inherit;">
                                                    <font style="vertical-align: inherit;">Bolsas de basura reciclada
                                                    </font>
                                                </font>
                                            </div>

                                            <div class="description" style="font-size:45px">
                                                <font style="vertical-align: inherit;">
                                                    <font style="vertical-align: inherit;">
                                                        78
                                                    </font>
                                                </font>
                                            </div>
                                            <br>
                                            <div class="meta">
                                                <font style="vertical-align: inherit;">
                                                    <font style="vertical-align: inherit;"><i
                                                            class="trash alternate icon"></i>
                                                    </font>
                                                </font>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div> }}
            {{!
                        </div> }}

          </div>
        </div>
      </div>
    </div>
  </div>
  <br /><br />
</div>

<script src="https://www.chartjs.org/dist/2.9.3/Chart.min.js"></script>
<script>

  const json= `{{{empresa.dataGraph}}}`;
  const str = JSON.parse(json);
  //Carga de data de graficas
  let datesTravels = str.map(function(item) {
    return item._id;
  });
  let dataTravels = str.map(function(item) {
    return item.viajes;
  });

  let dataCo2 = str.map(function(item) {
    return item.co2;
  });

  $('#line-chart3').hide();
    $('#filtrar').click(function() {
        $('#line-chart1').hide();
        $('#line-chart3').show();
    })
    $('#pdf').click(function() {
        var doc = new jsPDF();
        var elementHTML =
            $('#contenidoPf').html();
        var specialElementHandlers = {
            '#elementH': function(element, renderer) {
                return true;
            }
        };
        doc.fromHTML(elementHTML, 15, 15, {
            'width': 170,
            'elementHandlers': specialElementHandlers
        }); // Save the PDF
        doc.save('PDF.pdf');
    }) 
    
    new Chart(document.getElementById("line-chart"), {
        type: 'line',
        data: {
            labels: datesTravels,
            datasets: [{
                data: dataCo2,
                label: "Co2",
                borderColor: "#3cba9f",
                fill: false
            }]
        },
        /*options: { title: { display: true, text: 'World population per region (in
        millions)' } }*/
    });
    new Chart(document.getElementById("line-chart1"), {
        type: 'bar',
        data: {
            labels: datesTravels,
            datasets: [{
                data: dataTravels,
                label: "Viajes",
                backgroundColor: [
                    'rgb(6,224,201)', 'rgb(4,124,148)', 'rgb(4,91,105)', 'rgb(6,224,201)',
                    'rgb(4,124,148)', 'rgb(4,91,105)', 'rgb(6,224,201)'
                ],
                borderColor: "#06e0c9",
                fill: false
            }]
        },
        /*options: { title: { display: true, text: 'World
        population per region (in millions)' } }*/
    });
    new Chart(document.getElementById("line-chart3"), {
        type: 'bar',
        data: {
            labels: ['Sema 1', 'Sema 2', 'Sema 3', 'Sema 4'],
            datasets: [{
                data: [40, 14, 45, 17],
                label: "Viajes",
                borderColor: "#3cba9f",
                backgroundColor: ['rgb(6,224,201)',
                    'rgb(6,224,201)', 'rgb(6,224,201)', 'rgb(6,224,201)'
                ],
                fill: false
            }]
        },
        /*options: { title: { display: true, text: 'World population per region (in
        millions)' } }*/
    });
    new Chart(document.getElementById("line-chart2"), {
        type: 'pie',
        data: {
            labels: ['T. Publico', 'T.Privado', 'Mov Limpia'],
            datasets: [{
                data: [0.1, 0.1, 0.1],
                backgroundColor: ['rgb(6,224,201)',
                    'rgb(4,124,148)', 'rgb(4,91,105)'
                ],
                hoverOffset: 4
            }]
        },
        /*options: { title:
        { display: true, text: 'World population per region (in millions)' } }*/
    });
    /*$('#ppt').click(function () { import pptxgen from "pptxgenjs"; const pptx =
    new pptxgen(); const copyright = `© 2019 My copyright`;
    pptx.defineSlideMaster({ title: 'MASTER_SLIDE', bkgd: 'FFFFFF', objects: [ {
    image: { x: 10.7, y: scales.yTop, w: 2.3, h: 0.3, path: 'path/to/image/' } },
    { text: { text: copyright, options: { x: scales.xLeft, y: 6.9, w: 10, h: 0.75,
    fontSize: scales.fontSmall, color: 'A9A9A9' } } }, { image: { x: 11, y: 7, w:
    2, h: 0.23, path: 'path/to/image/' } }, ], }); })*/
</script>

<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.3/jspdf.min.js"
></script>

<script
  src="https://code.jquery.com/jquery-1.11.3.js"
  type="text/javascript"
></script>
<script
  src="https://jqueryui.com/jquery-wp-content/themes/jquery/js/plugins.js"
></script>
<script
  src="https://jqueryui.com/jquery-wp-content/themes/jquery/js/main.js"
></script>
<script type="text/javascript" src="/assets/js/semantic.min.js"></script>

<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
  rel="stylesheet"
  integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
  crossorigin="anonymous"
/>
<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
  crossorigin="anonymous"
></script>
<script
  src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
  integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
  crossorigin="anonymous"
></script>
<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
  integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
  crossorigin="anonymous"
></script>